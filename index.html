<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Veo3 Video Generator</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    input { padding: 10px; width: 400px; margin-right: 10px; }
    button { padding: 10px; }
    #status { margin-top: 10px; font-weight: bold; }
    video { display: block; margin-top: 20px; max-width: 100%; }
    .history { margin-top: 30px; }
    .history-item { margin-bottom: 20px; }
  </style>
</head>
<body>
  <h1>Veo3 Text-to-Video Generator</h1>

  <input id="prompt" placeholder="Type your video prompt here" />
  <button id="generate">Generate Video</button>
  <p id="status"></p>

  <video id="result" controls></video>

  <div class="history">
    <h2>Generated Videos</h2>
    <div id="history-container"></div>
  </div>

  <script>
    const API_KEY = "sk-4dea413565fb4e3faacc29a5324dfc66"; // <-- Paste your Veo3API key here

    async function generateVideo(prompt) {
      document.getElementById("status").textContent = "Submitting request...";
      try {
        // 1️⃣ Submit video request
        const res = await fetch("https://veo3api.com/generate", {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${API_KEY}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            prompt,
            model: "veo3-fast",
            duration: 5,
            watermark: "veo"
          })
        });

        const data = await res.json();
        const taskId = data.data.task_id;

        // 2️⃣ Poll for video completion
        async function poll() {
          const statusRes = await fetch(`https://veo3api.com/status/${taskId}`, {
            headers: {
              "Authorization": `Bearer ${API_KEY}`,
              "Content-Type": "application/json"
            }
          });

          const statusData = await statusRes.json();

          if (statusData.data.status === "completed") {
            document.getElementById("status").textContent = "Video ready!";
            return statusData.data.video_url;
          } else if (statusData.data.status === "failed") {
            throw new Error("Video generation failed");
          } else {
            document.getElementById("status").textContent = "Generating video...";
            await new Promise(r => setTimeout(r, 3000));
            return poll();
          }
        }

        return await poll();
      } catch (err) {
        document.getElementById("status").textContent = err.message;
        console.error(err);
      }
    }

    function addVideoToHistory(prompt, url) {
      const container = document.getElementById("history-container");
      const div = document.createElement("div");
      div.className = "history-item";
      div.innerHTML = `
        <strong>Prompt:</strong> ${prompt}<br>
        <video src="${url}" controls></video>
      `;
      container.prepend(div);
    }

    document.getElementById("generate").addEventListener("click", async () => {
      const prompt = document.getElementById("prompt").value;
      if (!prompt) {
        alert("Please enter a prompt!");
        return;
      }

      const videoUrl = await generateVideo(prompt);
      if (videoUrl) {
        document.getElementById("result").src = videoUrl;
        addVideoToHistory(prompt, videoUrl);
      }
    });
  </script>
</body>
</html>
